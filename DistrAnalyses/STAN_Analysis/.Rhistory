######## Tau
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta_t[1]")$mean
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[3]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[7]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[9]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[4]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[7]")$mean+ subset(model, X == "beta_t[9]")$mean   + subset(model, X == "beta_t[11]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[8]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[10]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[5]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[8]")$mean+ subset(model, X == "beta_t[10]")$mean   + subset(model, X == "beta_t[12]")$mean)
# Subtract constant to get real Values
model.graph[model.graph$Parameter == "Mu",]$Value <- model.graph[model.graph$Parameter == "Mu",]$Value - 500
ggplot(data = model.graph, aes(x = AnswerType, y = Value)) +
geom_bar(stat = "identity", position = "dodge", aes(fill = SceneType)) +
facet_wrap(~Parameter+Age)
?ordered
model.graph[model.graph$Parameter == "Mu",]$Value <- model.graph[model.graph$Parameter == "Mu",]$Value - 500
model.graph$Age <- ordered(model.graph$Age, levels = c("Adult","5-year-old","3-year-old"))
ggplot(data = model.graph, aes(x = AnswerType, y = Value)) +
geom_bar(stat = "identity", position = "dodge", aes(fill = SceneType)) +
facet_wrap(~Parameter+Age)
model.graph
model <- read.csv("fixEf_Transf3_output.csv", header = T)
model.graph = data.frame(Age = rep(rep(c("Adult","5-yr-old","3-yr-old"), each = 4), times = 3),
AnswerType = rep(rep(c("Predictable","Unpredictable"), each = 2),times = 9),
SceneType = rep(c("Match","Mismatch"), times = 18),
Parameter = rep(c("Mu", "Sigma","Tau"), each = 12))
model.graph$Value = NA
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta[1]")$mean
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[3]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean + subset(model, X == "beta[2]")$mean  + subset(model, X == "beta[7]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean + subset(model, X == "beta[3]")$mean+ subset(model, X == "beta[9]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean+ subset(model, X == "beta[4]")$mean  + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean+ subset(model, X == "beta[7]")$mean+ subset(model, X == "beta[9]")$mean   + subset(model, X == "beta[11]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean + subset(model, X == "beta[2]")$mean  + subset(model, X == "beta[8]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean + subset(model, X == "beta[3]")$mean+ subset(model, X == "beta[10]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean+ subset(model, X == "beta[5]")$mean  + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean+ subset(model, X == "beta[8]")$mean+ subset(model, X == "beta[10]")$mean   + subset(model, X == "beta[12]")$mean)
######## Sigma
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta_s[1]")$mean
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[3]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean + subset(model, X == "beta_s[2]")$mean  + subset(model, X == "beta_s[7]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean + subset(model, X == "beta_s[3]")$mean+ subset(model, X == "beta_s[9]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean+ subset(model, X == "beta_s[4]")$mean  + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean+ subset(model, X == "beta_s[7]")$mean+ subset(model, X == "beta_s[9]")$mean   + subset(model, X == "beta_s[11]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean + subset(model, X == "beta_s[2]")$mean  + subset(model, X == "beta_s[8]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean + subset(model, X == "beta_s[3]")$mean+ subset(model, X == "beta_s[10]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean+ subset(model, X == "beta_s[5]")$mean  + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean+ subset(model, X == "beta_s[8]")$mean+ subset(model, X == "beta_s[10]")$mean   + subset(model, X == "beta_s[12]")$mean)
######## Tau
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta_t[1]")$mean
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[3]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[7]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[9]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[4]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[7]")$mean+ subset(model, X == "beta_t[9]")$mean   + subset(model, X == "beta_t[11]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[8]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[10]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[5]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[8]")$mean+ subset(model, X == "beta_t[10]")$mean   + subset(model, X == "beta_t[12]")$mean)
# Subtract constant to get real Values
model.graph[model.graph$Parameter == "Mu",]$Value <- model.graph[model.graph$Parameter == "Mu",]$Value - 500
model.graph$Age <- ordered(model.graph$Age, levels = c("Adult","5-yr-old","3-yr-old"))
ggplot(data = model.graph, aes(x = AnswerType, y = Value)) +
geom_bar(stat = "identity", position = "dodge", aes(fill = SceneType)) +
facet_wrap(~Parameter+Age)
library(retimes)
library(rstan)
ads <- read.csv("Adult_R.csv")
fives <- read.csv("5yo_R.csv")
threes <- read.csv("3yo_R.csv")
ads$Age <- "Adult"
fives$Age <- "Five"
threes$Age <- "Three"
tt <- rbind(ads,fives,threes)
tt$Age <- as.factor(tt$Age)
tt$Subject <- paste(tt$Age,tt$Participant, sep = "")
tt<- subset(tt, RTms <= 8000)
tt$rt <- tt$RTms
tt$N_Match <- ifelse(tt$Match == "Match",0,1)
tt$N_Pred <- ifelse(tt$Pred == "Pred",0,1)
tt$N_AgeFive <- model.matrix(~tt$Age)[,2]
tt$N_AgeThree <- model.matrix(~tt$Age)[,3]
tt$N_M_P_Interact <- tt$N_Pred * tt$N_Match
tt$N_Match_AgeFive_Interact <-  tt$N_Match * tt$N_AgeFive
tt$N_Match_AgeThree_Interact <- tt$N_Match * tt$N_AgeThree
tt$N_Pred_AgeFive_Interact <- tt$N_Pred * tt$N_AgeFive
tt$N_Pred_AgeThree_Interact <- tt$N_Pred * tt$N_AgeThree
tt$N_Match_Pred_AgeFive_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeFive
tt$N_Match_Pred_AgeThree_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeThree
# For some reason, model won't converge with RTs above zero?
tt$rt <- tt$rt + abs(min(tt$rt))
# Fit Ex-Gaussian using ML (retimes library)
eg_ml <- timefit(tt$rt)
print(eg_ml)
library(retimes)
library(rstan)
ads <- read.csv("Adult_R.csv")
fives <- read.csv("5yo_R.csv")
threes <- read.csv("3yo_R.csv")
ads$Age <- "Adult"
fives$Age <- "Five"
threes$Age <- "Three"
tt <- rbind(ads,fives,threes)
tt$Age <- as.factor(tt$Age)
tt$Subject <- paste(tt$Age,tt$Participant, sep = "")
tt<- subset(tt, RTms <= 8000)
tt$rt <- tt$RTms
tt$N_Match <- ifelse(tt$Match == "Match",0,1)
tt$N_Pred <- ifelse(tt$Pred == "Pred",0,1)
tt$N_AgeFive <- model.matrix(~tt$Age)[,2]
tt$N_AgeThree <- model.matrix(~tt$Age)[,3]
tt$N_M_P_Interact <- tt$N_Pred * tt$N_Match
tt$N_Match_AgeFive_Interact <-  tt$N_Match * tt$N_AgeFive
tt$N_Match_AgeThree_Interact <- tt$N_Match * tt$N_AgeThree
tt$N_Pred_AgeFive_Interact <- tt$N_Pred * tt$N_AgeFive
tt$N_Pred_AgeThree_Interact <- tt$N_Pred * tt$N_AgeThree
tt$N_Match_Pred_AgeFive_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeFive
tt$N_Match_Pred_AgeThree_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeThree
# For some reason, model won't converge with RTs above zero?
#tt$rt <- tt$rt + abs(min(tt$rt))
# Fit Ex-Gaussian using ML (retimes library)
eg_ml <- timefit(tt$rt)
print(eg_ml)
abs(min(tt$rt))
# NOTE THAT FOR THESE ANALYSES YOU TYPICALLY NEED TO INCLUDE THE LONG RT TAIL. I recommend rt <8000
library(ggplot2)
library(reshape2)
library(retimes)
library(doBy)
library(ez)
library(plyr)
ads <- read.csv("Adult_R.csv")
fives <- read.csv("5yo_R.csv")
threes <- read.csv("3yo_R.csv")
ads$Age <- "Adult"
fives$Age <- "Five"
threes$Age <- "Three"
tt <- rbind(ads,fives,threes)
tt$Age <- as.factor(tt$Age)
tt$Subject <- paste(tt$Age,tt$Participant, sep = "")
tt<- subset(tt, RTms <= 8000)
#tt$RTms <- tt$RTms + abs(min(tt$RTms))
d = data.frame(Subject = rep(NA, times = length(unique(tt$Subject))*4), Pred = NA, Match = NA, Age = NA, Mu = NA, Sigma = NA, Tau = NA)
index = 1
for (k in unique(tt$Pred)){
for (j in unique(subset(tt, Pred == k)$Subj)){
for (i in unique(subset(tt, Pred == k & Subject == j)$Match)){
a = timefit(subset(tt, Pred == k & Subject == j & Match == i )$RTms)
d$Age[index] <- as.character(unique(subset(tt, Pred == k & Subject == j & Match == i )$Age)[1])
d$Subject[index] <- j
d$Pred[index] <- k
d$Match[index] <- i
d$Mu[index] <- a@par[1]
d$Sigma[index] <- a@par[2]
d$Tau[index] <- a@par[3]
index <- index + 1
}
}
}
re.summary <- summaryBy(Mu + Sigma+ Tau ~ Age+Pred + Match, data = d, FUN = c(mean))
ezANOVA(d, dv = Mu, wid = Subject, within = .(Pred,Match), between = .(Age))
ezANOVA(d, dv = Sigma, wid = Subject, within = .(Pred,Match), between = .(Age))
ezANOVA(d, dv = Tau, wid = Subject, within = .(Pred,Match), between = .(Age))
re.summary.gg <- melt(re.summary,id.vars = c("Age","Pred","Match"), variable.name = "Parameter",value.name = "Value")
ggplot(data = re.summary.gg, aes(x = Pred, y = Value)) +
geom_bar(stat = "identity", position = "dodge", aes(fill = Match)) +
facet_wrap(~Parameter+Age)
# Now for all individuals
#tt<- subset(tt, Incorrect == 0)
d = data.frame(Pred = rep(NA, length = 12), Match = NA, Age = NA, Mu = NA, Sigma = NA, Tau = NA)
index = 1
for (k in unique(tt$Pred)){
for (j in unique(subset(tt, Pred == k)$Age)){
for (i in unique(subset(tt, Pred == k & Age == j)$Match)){
a = timefit(subset(tt, Pred == k & Age == j & Match == i )$RTms)
d$Age[index] <- j
d$Pred[index] <- k
d$Match[index] <- i
d$Mu[index] <- a@par[1]
d$Sigma[index] <- a@par[2]
d$Tau[index] <- a@par[3]
index <- index + 1
}
}
}
re.summary <- summaryBy(Mu + Sigma+ Tau ~ Age+Pred + Match, data = d, FUN = c(mean))
re.summary.gg <- melt(re.summary,id.vars = c("Age","Pred","Match"), variable.name = "Parameter",value.name = "Value")
ggplot(data = re.summary.gg, aes(x = Pred, y = Value)) +
geom_bar(stat = "identity", position = "dodge", aes(fill = Match)) +
facet_wrap(~Parameter+Age)
re.summary.mean <- summaryBy(RTms ~ Subject + Age+Pred + Match, data = tt, FUN = c(mean), keep.names = T)
summaryBy(RTms ~ Age+Pred + Match, data = re.summary.mean, FUN = c(mean))
ezANOVA(re.summary.mean, dv = RTms, wid = Subject, within = .(Pred,Match), between = .(Age))
setwd("~/GitHub/iPad_TurnTaking/DistrAnalyses/STAN_Analysis")
abs(min(tt$rt))
library(retimes)
library(rstan)
ads <- read.csv("Adult_R.csv")
fives <- read.csv("5yo_R.csv")
threes <- read.csv("3yo_R.csv")
ads$Age <- "Adult"
fives$Age <- "Five"
threes$Age <- "Three"
tt <- rbind(ads,fives,threes)
tt$Age <- as.factor(tt$Age)
tt$Subject <- paste(tt$Age,tt$Participant, sep = "")
tt<- subset(tt, RTms <= 8000)
tt$rt <- tt$RTms
tt$N_Match <- ifelse(tt$Match == "Match",0,1)
tt$N_Pred <- ifelse(tt$Pred == "Pred",0,1)
tt$N_AgeFive <- model.matrix(~tt$Age)[,2]
tt$N_AgeThree <- model.matrix(~tt$Age)[,3]
tt$N_M_P_Interact <- tt$N_Pred * tt$N_Match
tt$N_Match_AgeFive_Interact <-  tt$N_Match * tt$N_AgeFive
tt$N_Match_AgeThree_Interact <- tt$N_Match * tt$N_AgeThree
tt$N_Pred_AgeFive_Interact <- tt$N_Pred * tt$N_AgeFive
tt$N_Pred_AgeThree_Interact <- tt$N_Pred * tt$N_AgeThree
tt$N_Match_Pred_AgeFive_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeFive
tt$N_Match_Pred_AgeThree_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeThree
# For some reason, model won't converge with RTs above zero?
tt$rt <- tt$rt + abs(min(tt$rt))
abs(min(tt$rt))
library(retimes)
library(rstan)
ads <- read.csv("Adult_R.csv")
fives <- read.csv("5yo_R.csv")
threes <- read.csv("3yo_R.csv")
ads$Age <- "Adult"
fives$Age <- "Five"
threes$Age <- "Three"
tt <- rbind(ads,fives,threes)
tt$Age <- as.factor(tt$Age)
tt$Subject <- paste(tt$Age,tt$Participant, sep = "")
tt<- subset(tt, RTms <= 8000)
tt$rt <- tt$RTms
tt$N_Match <- ifelse(tt$Match == "Match",0,1)
tt$N_Pred <- ifelse(tt$Pred == "Pred",0,1)
tt$N_AgeFive <- model.matrix(~tt$Age)[,2]
tt$N_AgeThree <- model.matrix(~tt$Age)[,3]
tt$N_M_P_Interact <- tt$N_Pred * tt$N_Match
tt$N_Match_AgeFive_Interact <-  tt$N_Match * tt$N_AgeFive
tt$N_Match_AgeThree_Interact <- tt$N_Match * tt$N_AgeThree
tt$N_Pred_AgeFive_Interact <- tt$N_Pred * tt$N_AgeFive
tt$N_Pred_AgeThree_Interact <- tt$N_Pred * tt$N_AgeThree
tt$N_Match_Pred_AgeFive_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeFive
tt$N_Match_Pred_AgeThree_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeThree
# For some reason, model won't converge with RTs above zero?
tt$rt <- tt$rt + abs(min(tt$rt))
# Fit Ex-Gaussian using ML (retimes library)
eg_ml <- timefit(tt$rt)
print(eg_ml)
abs(min(tt$rt))
library(retimes)
library(rstan)
ads <- read.csv("Adult_R.csv")
fives <- read.csv("5yo_R.csv")
threes <- read.csv("3yo_R.csv")
ads$Age <- "Adult"
fives$Age <- "Five"
threes$Age <- "Three"
tt <- rbind(ads,fives,threes)
tt$Age <- as.factor(tt$Age)
tt$Subject <- paste(tt$Age,tt$Participant, sep = "")
tt<- subset(tt, RTms <= 8000)
tt$rt <- tt$RTms
tt$N_Match <- ifelse(tt$Match == "Match",0,1)
tt$N_Pred <- ifelse(tt$Pred == "Pred",0,1)
tt$N_AgeFive <- model.matrix(~tt$Age)[,2]
tt$N_AgeThree <- model.matrix(~tt$Age)[,3]
tt$N_M_P_Interact <- tt$N_Pred * tt$N_Match
tt$N_Match_AgeFive_Interact <-  tt$N_Match * tt$N_AgeFive
tt$N_Match_AgeThree_Interact <- tt$N_Match * tt$N_AgeThree
tt$N_Pred_AgeFive_Interact <- tt$N_Pred * tt$N_AgeFive
tt$N_Pred_AgeThree_Interact <- tt$N_Pred * tt$N_AgeThree
tt$N_Match_Pred_AgeFive_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeFive
tt$N_Match_Pred_AgeThree_Interact <- tt$N_Match * tt$N_Pred * tt$N_AgeThree
# For some reason, model won't converge with RTs above zero?
#tt$rt <- tt$rt + abs(min(tt$rt))
# Fit Ex-Gaussian using ML (retimes library)
eg_ml <- timefit(tt$rt)
print(eg_ml)
abs(min(tt$rt))
model <- read.csv("fixEf_Transf3_output.csv", header = T)
model.graph = data.frame(Age = rep(rep(c("Adult","5-yr-old","3-yr-old"), each = 4), times = 3),
AnswerType = rep(rep(c("Predictable","Unpredictable"), each = 2),times = 9),
SceneType = rep(c("Match","Mismatch"), times = 18),
Parameter = rep(c("Mu", "Sigma","Tau"), each = 12))
model.graph$Value = NA
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta[1]")$mean
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[3]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean + subset(model, X == "beta[2]")$mean  + subset(model, X == "beta[7]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean + subset(model, X == "beta[3]")$mean+ subset(model, X == "beta[9]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean+ subset(model, X == "beta[4]")$mean  + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean+ subset(model, X == "beta[7]")$mean+ subset(model, X == "beta[9]")$mean   + subset(model, X == "beta[11]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean + subset(model, X == "beta[2]")$mean  + subset(model, X == "beta[8]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean + subset(model, X == "beta[3]")$mean+ subset(model, X == "beta[10]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean+ subset(model, X == "beta[5]")$mean  + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean+ subset(model, X == "beta[8]")$mean+ subset(model, X == "beta[10]")$mean   + subset(model, X == "beta[12]")$mean)
######## Sigma
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta_s[1]")$mean
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[3]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean + subset(model, X == "beta_s[2]")$mean  + subset(model, X == "beta_s[7]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean + subset(model, X == "beta_s[3]")$mean+ subset(model, X == "beta_s[9]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean+ subset(model, X == "beta_s[4]")$mean  + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean+ subset(model, X == "beta_s[7]")$mean+ subset(model, X == "beta_s[9]")$mean   + subset(model, X == "beta_s[11]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean + subset(model, X == "beta_s[2]")$mean  + subset(model, X == "beta_s[8]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean + subset(model, X == "beta_s[3]")$mean+ subset(model, X == "beta_s[10]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean+ subset(model, X == "beta_s[5]")$mean  + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean+ subset(model, X == "beta_s[8]")$mean+ subset(model, X == "beta_s[10]")$mean   + subset(model, X == "beta_s[12]")$mean)
######## Tau
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta_t[1]")$mean
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[3]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[7]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[9]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[4]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[7]")$mean+ subset(model, X == "beta_t[9]")$mean   + subset(model, X == "beta_t[11]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[8]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[10]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[5]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[8]")$mean+ subset(model, X == "beta_t[10]")$mean   + subset(model, X == "beta_t[12]")$mean)
# Subtract constant to get real Values
model.graph[model.graph$Parameter == "Mu",]$Value <- model.graph[model.graph$Parameter == "Mu",]$Value - 725
model.graph$Age <- ordered(model.graph$Age, levels = c("Adult","5-yr-old","3-yr-old"))
ggplot(data = model.graph, aes(x = AnswerType, y = Value)) +
geom_bar(stat = "identity", position = "dodge", aes(fill = SceneType)) +
facet_wrap(~Parameter+Age)
model <- read.csv("fixEf_Transf3_output.csv", header = T)
model.graph = data.frame(Age = rep(rep(c("Adult","5-yr-old","3-yr-old"), each = 4), times = 3),
AnswerType = rep(rep(c("Predictable","Unpredictable"), each = 2),times = 9),
SceneType = rep(c("Match","Mismatch"), times = 18),
Parameter = rep(c("Mu", "Sigma","Tau"), each = 12))
model.graph$Value = NA
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta[1]")$mean
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[3]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean + subset(model, X == "beta[2]")$mean  + subset(model, X == "beta[7]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[4]")$mean + subset(model, X == "beta[3]")$mean+ subset(model, X == "beta[9]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean+ subset(model, X == "beta[4]")$mean  + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean+ subset(model, X == "beta[7]")$mean+ subset(model, X == "beta[9]")$mean   + subset(model, X == "beta[11]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean + subset(model, X == "beta[2]")$mean  + subset(model, X == "beta[8]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[5]")$mean + subset(model, X == "beta[3]")$mean+ subset(model, X == "beta[10]")$mean)
model.graph[model.graph$Parameter == "Mu" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta[1]")$mean + subset(model, X == "beta[2]")$mean+ subset(model, X == "beta[5]")$mean  + subset(model, X == "beta[3]")$mean + subset(model, X == "beta[6]")$mean+ subset(model, X == "beta[8]")$mean+ subset(model, X == "beta[10]")$mean   + subset(model, X == "beta[12]")$mean)
######## Sigma
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta_s[1]")$mean
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[3]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean + subset(model, X == "beta_s[2]")$mean  + subset(model, X == "beta_s[7]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[4]")$mean + subset(model, X == "beta_s[3]")$mean+ subset(model, X == "beta_s[9]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean+ subset(model, X == "beta_s[4]")$mean  + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean+ subset(model, X == "beta_s[7]")$mean+ subset(model, X == "beta_s[9]")$mean   + subset(model, X == "beta_s[11]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean + subset(model, X == "beta_s[2]")$mean  + subset(model, X == "beta_s[8]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[5]")$mean + subset(model, X == "beta_s[3]")$mean+ subset(model, X == "beta_s[10]")$mean)
model.graph[model.graph$Parameter == "Sigma" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_s[1]")$mean + subset(model, X == "beta_s[2]")$mean+ subset(model, X == "beta_s[5]")$mean  + subset(model, X == "beta_s[3]")$mean + subset(model, X == "beta_s[6]")$mean+ subset(model, X == "beta_s[8]")$mean+ subset(model, X == "beta_s[10]")$mean   + subset(model, X == "beta_s[12]")$mean)
######## Tau
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- subset(model, X == "beta_t[1]")$mean
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[3]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "Adult" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[7]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[4]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[9]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "5-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[4]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[7]")$mean+ subset(model, X == "beta_t[9]")$mean   + subset(model, X == "beta_t[11]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Predictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[2]")$mean  + subset(model, X == "beta_t[8]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Match",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[5]")$mean + subset(model, X == "beta_t[3]")$mean+ subset(model, X == "beta_t[10]")$mean)
model.graph[model.graph$Parameter == "Tau" & model.graph$Age == "3-yr-old" & model.graph$AnswerType == "Unpredictable" &
model.graph$SceneType == "Mismatch",]$Value <- (subset(model, X == "beta_t[1]")$mean + subset(model, X == "beta_t[2]")$mean+ subset(model, X == "beta_t[5]")$mean  + subset(model, X == "beta_t[3]")$mean + subset(model, X == "beta_t[6]")$mean+ subset(model, X == "beta_t[8]")$mean+ subset(model, X == "beta_t[10]")$mean   + subset(model, X == "beta_t[12]")$mean)
# Subtract constant to get real Values
model.graph[model.graph$Parameter == "Mu",]$Value <- model.graph[model.graph$Parameter == "Mu",]$Value - 725
model.graph$Age <- ordered(model.graph$Age, levels = c("Adult","5-yr-old","3-yr-old"))
ggplot(data = model.graph, aes(x = AnswerType, y = Value)) +
geom_bar(stat = "identity", position = "dodge", aes(fill = SceneType)) +
facet_wrap(~Parameter+Age)
